# Benchopt configuration for distributed benchmarking
# This file specifies testing with 2 distributed processes

# Objective filter
objective:
  - reconstruction_objective

# Dataset filters (with parameters) - smaller size for faster distributed test
dataset:
  - highres_color_image:
      image_size: 256
      num_operators: 4
      noise_level: 0.1

# Solver filters (with parameters) - distributed version
solver:
  - PnP:
      denoiser: drunet
      force_cpu: true
      denoiser_sigma: 0.005
      step_size: 0.1
      init_method: ["zeros"]
      torchrun_nproc_per_node,OMP_NUM_THREADS,MKL_NUM_THREADS,distribute_physics, distribute_denoiser, patch_size, receptive_field_size, max_batch_size:   [
        [1,1,1,false, false, 0, 0, 0],        
        [1,2,2,false, false, 0, 0, 0],
        [1,4,4,false, false, 0, 0, 0],

        [2,1,1,false, true, 128, 32, 1],
        [2,1,1,true, false, 128, 32, 1],
        [2,1,1,true, true, 128, 32, 1],

        [2,2,2,false, true, 128, 32, 1],
        [2,2,2,true, false, 128, 32, 1],
        [2,2,2,true, true, 128, 32, 1],

        #[4,true, false, 0,0, 0],
        ]
      

# Run parameters

max-runs: 6
n-repetitions: 1
plot: true
html: true

